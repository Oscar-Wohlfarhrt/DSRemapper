<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>DSRemapper Documentation</title>
    <link rel="stylesheet" type="text/css" href="./../Styles.css" >
</head>
<body>
    <h1>Guía de inicio</h1>
    <p>
        Para entender como funciona un perfil, hay que entender su estructura
        y algunos conseptos basicos.
    </p>
    <p>
        Los perfiles se "vinculan" a un control/gamepad fisico conectado al PC.
    </p>
    <p>
        Una ves hecho esto, el perfil ejecutará un codigo que le dirá que hacer al iniciarse. 
    </p>
    <p>
        Cuando el perfil se haya configurado, deberá existir en este una funcion que será llamada
        periodicamente con el fin de actualizar los controles emulados. En el caso de no existir
        esta funcion, el perfil no intentará llamarla.
    </p>

    <h2>Partes del perfil</h2>
    <pcode>--[[
        
    Configuracion

--]]

--[Funcion de remapeo]--
function Remapper()

    --[[

        Acciones del Remapeo

    --]]

end

--[[
        
Configuracion

--]]</pcode>

    <ul>
        <li>Configuración: Aquí se realizan las operaciones que configuran el perfil</il>
        <li>Funcion de remapeo: Se llama cada ves que se requiere modificar el estado del mando emulado</il>
    </ul>

    <h3>Descripción de las partes</h3>
    <h4>Configuración</h4>
    <p>
        Se ejecuta al iniciarse el perfil.
    </p>
    <p>
        En esta instancia debería crearse al menos un control emulado y conectarlo.
        Como el codigo que está aca se ejecuta solo una ves al iniciar el perfil,
        no se podrá realizar ninguna otra accion una ves ejecutado.
    </p>
    <p>
        En esta seccion tambien se pueden definir funciones auxiliares para ayudar
        con el remapeo de los controles emulados.
    </p>

    <h4>Funcion de remapeo</h4>
    <p>
        Es una funcion a la cual se intenta llamar cada 10ms [milisegundos].
        <b>Es la unica funcion que se ejecuta de forma periodica, si existe,
        dentro del perfil sin necesidad de que el usuario tenga que llamarla.</b>
    </p>
    <p>
        El fin de esta funcion es que el usuario actualize la informacion de los
        controles emulados, por lo tanto, se debería llamar a la funcion
        <code>SetInputReport([report])</code> de los controles emulados creados.
    </p>

    <h2>Perfil basico</h2>
    <pcode>out1 = Utils.CreateInputReport() --Output Report creation--
ctrl1 = CreateXbox() --Emulated Controller creation--

--Without this Emulated Controller doesn't appear--
--Sin esto el Control Emulado no aparecera--
ctrl1.Connect() --Emulated Controller connection--

function Remapper()
    --Getting Emulated Controller feedback/rumble--
    out1FB = ctrl1.GetFeedbackReport()
    
    --Sticks--
    out1.LX=Utils.Deadzone(input.LX,0.1)
    out1.LY=Utils.Deadzone(input.LY,0.1)
    out1.RX=Utils.Deadzone(input.RX,0.1)
    out1.RY=Utils.Deadzone(input.RY,0.1)
    --Sticks--

    --Triggers--
    out1.LTrigger=Utils.Deadzone(input.LTrigger,0.05)
    out1.RTrigger=Utils.Deadzone(input.RTrigger,0.05)
    --Triggers--

    --DPad--
    out1.Up=input.Up
    out1.Down=input.Down
    out1.Left=input.Left
    out1.Right=input.Right
    --DPad--

    --Buttons--
    out1.Options=input.Options
    out1.Share=input.Share

    out1.L1=input.L1
    out1.R1=input.R1
    out1.L2=input.L2
    out1.R2=input.R2
    out1.L3=input.L3
    out1.R3=input.R3

    out1.Cross=input.Cross
    out1.Circle=input.Circle
    out1.Square=input.Square
    out1.Triangle=input.Triangle
    
    out1.PS=input.PS
    out1.TouchClick=input.TouchClick
    --Buttons--
    
    --Light Bar (DualShock 4 only)--
    inputFB.Red=0.2
    inputFB.Green=0.1
    inputFB.Blue=0
    --Light Bar (DualShock 4 only)--
    
    --Rumble--
    inputFB.Weak=out1FB.Weak
    inputFB.Strong=out1FB.Strong
    --Rumble--
    
    --Emulated Controller Update--
    ctrl1.SetInputReport(out1)
end</pcode>
</body>
</html>